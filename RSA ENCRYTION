import java.math.BigInteger;
import java.security.SecureRandom;

public class RSA {
    BigInteger n,d,e;
    RSA(int bits){
        SecureRandom r=new SecureRandom();
        BigInteger p=new BigInteger(bits/2,100,r);
        BigInteger q=new BigInteger(bits/2,100,r);
        n=p.multiply(q);
        BigInteger phi=p.subtract(BigInteger.ONE).multiply(q.subtract(BigInteger.ONE));
        e=BigInteger.valueOf(65537);
        d=e.modInverse(phi);
    }
    BigInteger encrypt(BigInteger m){ return m.modPow(e,n); }
    BigInteger decrypt(BigInteger c){ return c.modPow(d,n); }
    public static void main(String[] args){
        RSA rsa=new RSA(512);
        BigInteger msg=new BigInteger("42");
        BigInteger enc=rsa.encrypt(msg);
        BigInteger dec=rsa.decrypt(enc);
        System.out.println("Encrypted: "+enc+"\nDecrypted: "+dec);
    }
}
